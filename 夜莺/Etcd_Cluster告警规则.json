[
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd Leader é€‰ä¸¾å¼‚å¸¸å‘Šè­¦",
    "note": "{{$labels.instance}} etcd èŠ‚ç‚¹æœªé€‰å‡º Leader\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ å½“å‰çŠ¶æ€ï¼šæ—  Leader (etcd_server_has_leader = 0)  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šetcd èŠ‚ç‚¹æœªé€‰å‡º Leader\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ etcd é›†ç¾¤ç¼ºå°‘ Leaderï¼Œå†™æ“ä½œå°†è¢«é˜»å¡ï¼Œå¯¼è‡´é›†ç¾¤ä¸å¯ç”¨  \nâœ“ ä¾èµ– etcd çš„æœåŠ¡å¯èƒ½å‡ºç°æ•…éšœï¼Œå¦‚ Kubernetes API æœåŠ¡å¼‚å¸¸  \nâœ“ å¯èƒ½ç”±äºç½‘ç»œåˆ†åŒºã€èŠ‚ç‚¹æ•…éšœæˆ–é…ç½®å¼‚å¸¸å¯¼è‡´ Leader é€‰ä¸¾å¤±è´¥  \n\nè¯·æ£€æŸ¥ etcd èŠ‚ç‚¹çŠ¶æ€ã€ç½‘ç»œè¿æ¥åŠæ—¥å¿—ï¼Œç¡®ä¿ Leader æ­£å¸¸é€‰ä¸¾",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "etcd_server_has_leader{job=~\".*etcd.*\"} == 0",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd Leader é¢‘ç¹åˆ‡æ¢å‘Šè­¦",
    "note": "etcd é›†ç¾¤ Leader é¢‘ç¹åˆ‡æ¢å‘Šè­¦\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ è¿‡å» 15 åˆ†é’Ÿ Leader åˆ‡æ¢æ¬¡æ•°ï¼š{{ printf \"%.0f\" $value }}  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šLeader åˆ‡æ¢æ¬¡æ•° â‰¥ 4 æ¬¡\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ Leader é¢‘ç¹åˆ‡æ¢å¯èƒ½å¯¼è‡´ etcd é›†ç¾¤ä¸ç¨³å®šï¼Œå½±å“å†™å…¥æ“ä½œæ€§èƒ½  \nâœ“ å¯èƒ½å¼•å‘æœåŠ¡ä¸­æ–­ã€æ•°æ®ä¸€è‡´æ€§é£é™©  \nâœ“ å¯èƒ½ç”±ç½‘ç»œæŠ–åŠ¨ã€èŠ‚ç‚¹è´Ÿè½½è¿‡é«˜æˆ–ç¡¬ä»¶æ•…éšœå¼•èµ·  \n\nè¯·æ’æŸ¥ etcd èŠ‚ç‚¹è´Ÿè½½ã€ç½‘ç»œçŠ¶å†µåŠç›¸å…³æ—¥å¿—ï¼Œä¿éšœé›†ç¾¤ç¨³å®šæ€§",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "increase((max without (instance) (etcd_server_leader_changes_seen_total{job=~\".*etcd.*\"}) or 0*absent(etcd_server_leader_changes_seen_total{job=~\".*etcd.*\"}))[15m:1m]) >= 4",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd WAL fsync å»¶è¿Ÿè¿‡é«˜å‘Šè­¦ï¼ˆP99ï¼‰",
    "note": "etcd WAL æ—¥å¿—è½ç›˜å»¶è¿Ÿå‡é«˜ï¼ˆP99ï¼‰\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ å½“å‰ WAL è½ç›˜å»¶è¿Ÿ P99ï¼š{{ printf \"%.3f\" $value }} ç§’  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šfsync P99 å»¶è¿Ÿè¶…è¿‡ 0.5 ç§’ï¼ˆ5 åˆ†é’Ÿçª—å£ï¼‰\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ WAL æ˜¯ etcd å†™å…¥ä¸€è‡´æ€§çš„æ ¸å¿ƒæœºåˆ¶ï¼Œfsync å»¶è¿Ÿå‡é«˜å°†ä¸¥é‡å½±å“å†™å…¥æ€§èƒ½  \nâœ“ å¯èƒ½å› ç£ç›˜ I/O æŠ–åŠ¨ã€è®¾å¤‡æ•…éšœã€è´Ÿè½½è¿‡é«˜ç­‰å¼•èµ·  \nâœ“ å†™å…¥å»¶è¿Ÿé«˜å¯èƒ½å¯¼è‡´ Kubernetes ç­‰ä¾èµ–ç»„ä»¶è¶…æ—¶æˆ–çŠ¶æ€ä¸ä¸€è‡´  \n\nè¯·ç«‹å³æ£€æŸ¥èŠ‚ç‚¹ç£ç›˜è´Ÿè½½ã€I/O æ€§èƒ½ï¼Œæ’æŸ¥å¯èƒ½çš„å†™å…¥ç“¶é¢ˆæˆ–ç³»ç»Ÿè´Ÿè½½å¼‚å¸¸",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "histogram_quantile(0.99, rate(etcd_disk_wal_fsync_duration_seconds_bucket{job=~\".*etcd.*\"}[5m])) > 0.5",
          "severity": 3,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd WAL æ—¥å¿— fsync å»¶è¿Ÿè¿‡é«˜å‘Šè­¦ï¼ˆP99ï¼‰",
    "note": "etcd WAL æ—¥å¿—è½ç›˜å»¶è¿Ÿå¼‚å¸¸å‡é«˜ï¼ˆP99ï¼‰\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ å½“å‰ WAL è½ç›˜å»¶è¿Ÿ P99ï¼š{{ printf \"%.3f\" $value }} ç§’  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šfsync P99 å»¶è¿Ÿè¶…è¿‡ 1 ç§’ï¼ˆ5 åˆ†é’Ÿçª—å£ï¼‰\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ WAL fsync å»¶è¿Ÿè¿‡é«˜ï¼Œå¯èƒ½ä¸¥é‡å½±å“ etcd å†™å…¥æ€§èƒ½å’Œç³»ç»Ÿå“åº”  \nâœ“ å¯¼è‡´ etcd å†™æ“ä½œé˜»å¡ï¼ŒKubernetes ç­‰ç»„ä»¶å¯èƒ½å‡ºç° API å»¶è¿Ÿæˆ–è¶…æ—¶  \nâœ“ å¯èƒ½åŸå› åŒ…æ‹¬ç£ç›˜ I/O ç“¶é¢ˆã€ç¡¬ä»¶æ•…éšœã€ç³»ç»Ÿè´Ÿè½½è¿‡é«˜ç­‰\n\nè¯·åŠæ—¶æ’æŸ¥ç£ç›˜å¥åº·çŠ¶å†µã€I/O æ€§èƒ½æŒ‡æ ‡åŠç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "histogram_quantile(0.99, rate(etcd_disk_wal_fsync_duration_seconds_bucket{job=~\".*etcd.*\"}[5m])) > 1",
          "severity": 1,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd å†™å…¥äº‹åŠ¡å¼‚å¸¸å‘Šè­¦",
    "note": "etcd æè®®æäº¤å¤±è´¥é€Ÿç‡è¿‡é«˜\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ å½“å‰å¤±è´¥é€Ÿç‡ï¼š{{ printf \"%.2f\" $value }} æ¬¡/ç§’  \nâ–¸ è§¦å‘æ¡ä»¶ï¼š15 åˆ†é’Ÿå†…æè®®æäº¤å¤±è´¥é€Ÿç‡è¶…è¿‡ 5 æ¬¡/ç§’  \nâ–¸ æŒ‡æ ‡ï¼š`etcd_server_proposals_failed_total`\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ etcd èŠ‚ç‚¹å¯èƒ½æ— æ³•æ­£å¸¸å†™å…¥ï¼Œä¸¥é‡å½±å“ Kubernetes é…ç½®åŒæ­¥  \nâœ“ é«˜å¤±è´¥ç‡å¯èƒ½ç”±ç£ç›˜ I/O é—®é¢˜ã€ç½‘ç»œåˆ†åŒºã€leader å¼‚å¸¸ç­‰å¼•èµ·  \nâœ“ Kubernetes æ§åˆ¶é¢ç»„ä»¶å¯èƒ½å› æ­¤è¶…æ—¶æˆ–æŠ¥é”™  \n\nè¯·ç«‹å³æ£€æŸ¥ etcd èŠ‚ç‚¹çŠ¶æ€ã€ç£ç›˜æ€§èƒ½ã€ç½‘ç»œé“¾è·¯ï¼Œå¹¶å…³æ³¨ etcd æ—¥å¿—ä¸­çš„é”™è¯¯è¯¦æƒ…",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "rate(etcd_server_proposals_failed_total{job=~\".*etcd.*\"}[15m]) > 5",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd åç«¯æäº¤å»¶è¿Ÿè¿‡é«˜å‘Šè­¦ï¼ˆP99ï¼‰",
    "note": "etcd åç«¯äº‹åŠ¡æäº¤å»¶è¿Ÿå‡é«˜ï¼ˆP99ï¼‰\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ å½“å‰äº‹åŠ¡æäº¤å»¶è¿Ÿ P99ï¼š{{ printf \"%.3f\" $value }} ç§’  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šetcd backend commit æ“ä½œ P99 å»¶è¿Ÿè¶…è¿‡ 0.25 ç§’ï¼ˆ5 åˆ†é’Ÿçª—å£ï¼‰\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ etcd åç«¯å†™å…¥æ€§èƒ½ä¸‹é™ï¼Œå¯èƒ½å¯¼è‡´äº‹åŠ¡å†™æ…¢ã€å“åº”è¶…æ—¶  \nâœ“ Kubernetes ç­‰ä¾èµ– etcd çš„ç³»ç»Ÿå¯èƒ½å‡ºç°é…ç½®å˜æ›´å»¶è¿Ÿ  \nâœ“ æ½œåœ¨åŸå› åŒ…æ‹¬ç£ç›˜å†™å…¥å‹åŠ›è¿‡å¤§ã€ç³»ç»Ÿè´Ÿè½½é«˜ã€æ–‡ä»¶ç³»ç»Ÿå¼‚å¸¸ç­‰\n\nå»ºè®®æ£€æŸ¥ etcd èŠ‚ç‚¹ç£ç›˜æ€§èƒ½ã€I/O å»¶è¿Ÿã€ç³»ç»Ÿè´Ÿè½½æƒ…å†µï¼Œå¹¶å…³æ³¨æ˜¯å¦å­˜åœ¨é¢‘ç¹å†™æ“ä½œæˆ–èµ„æºæŠ¢å ",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "histogram_quantile(0.99, rate(etcd_disk_backend_commit_duration_seconds_bucket{job=~\".*etcd.*\"}[5m])) > 0.25",
          "severity": 3,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd å“åº”å¼‚å¸¸æ¯”ä¾‹è¶…é˜ˆå€¼",
    "note": "etcd èŠ‚ç‚¹å¼‚å¸¸ gRPC è¯·æ±‚æ¯”ä¾‹è¿‡é«˜\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ å¼‚å¸¸è¯·æ±‚å æ¯”ï¼š{{ printf \"%.2f\" $value }}%  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šå¼‚å¸¸ gRPC è¯·æ±‚æ¯”ä¾‹è¶…è¿‡ 5%  \nâ–¸ å¼‚å¸¸ç ç±»å‹ï¼šUnknownã€FailedPreconditionã€ResourceExhaustedã€Internalã€Unavailableã€DataLossã€DeadlineExceeded  \n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ etcd è¿”å›å¤§é‡å¼‚å¸¸çŠ¶æ€ç å¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯è°ƒç”¨å¤±è´¥  \nâœ“ é—´æ­‡æ€§æˆ–æŒç»­æ€§çš„é”™è¯¯ä¼šå½±å“ Kubernetes ç­‰ç³»ç»Ÿçš„ç¨³å®šæ€§  \nâœ“ å¯èƒ½ç”±ç£ç›˜ I/Oã€å†…å­˜ã€ç½‘ç»œæŠ–åŠ¨æˆ– etcd å‹åŠ›è¿‡é«˜å¼•èµ·  \n\nè¯·ç«‹å³æ£€æŸ¥ etcd èŠ‚ç‚¹æ—¥å¿—ã€ç³»ç»Ÿèµ„æºå’Œç½‘ç»œçŠ¶å†µï¼ŒåŠæ—¶æ’æŸ¥å¼‚å¸¸è¯·æ±‚æ¥æº",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "100 * sum(rate(grpc_server_handled_total{job=~\".*etcd.*\", grpc_code=~\"Unknown|FailedPrecondition|ResourceExhausted|Internal|Unavailable|DataLoss|DeadlineExceeded\"}[5m])) without (grpc_type, grpc_code)\n/\nsum(rate(grpc_server_handled_total{job=~\".*etcd.*\"}[5m])) without (grpc_type, grpc_code)\n> 5",
          "severity": 1,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd å­˜å‚¨é…é¢å³å°†è€—å°½å‘Šè­¦",
    "note": "etcd åç«¯å­˜å‚¨é¢„è®¡å°† 4 å°æ—¶åå†™æ»¡\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ å½“å‰å­˜å‚¨ä½¿ç”¨é‡ï¼šä¸å¯ç”¨ï¼ˆé¢„æµ‹ï¼‰  \nâ–¸ å­˜å‚¨é…é¢é™åˆ¶ï¼šä¸å¯ç”¨ï¼ˆé™æ€ï¼‰  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šæ ¹æ®è¿‡å» 4 å°æ—¶å¢é•¿è¶‹åŠ¿ï¼Œé¢„è®¡ 4 å°æ—¶åå°†è¶…è¿‡é…é¢é™åˆ¶\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ ä¸€æ—¦ etcd åç«¯å†™æ»¡ï¼Œå°†æ— æ³•å†™å…¥æ–°æ•°æ®ï¼Œå¯¼è‡´ Kubernetes ç­‰ä¾èµ–ç»„ä»¶å¤±æ•ˆ  \nâœ“ å¯èƒ½å¼•èµ·èŠ‚ç‚¹æ¼‚ç§»ã€API è¶…æ—¶ã€é…ç½®æ— æ³•ä¿å­˜ç­‰ä¸¥é‡åæœ  \nâœ“ å¿«é€Ÿå¢é•¿é€šå¸¸ç”±é¢‘ç¹å†™æ“ä½œã€å¤§é‡äº‹ä»¶ã€æˆ–èµ„æºæ¸…ç†ä¸åŠæ—¶å¼•èµ·\n\nå»ºè®®ç«‹å³æ£€æŸ¥ etcd æ•°æ®åº“ä½¿ç”¨å¢é•¿è¶‹åŠ¿ï¼Œå¯ç”¨ compaction æ¸…ç†æœºåˆ¶ï¼Œæˆ–é€‚å½“æ‰©å¤§åç«¯é…é¢é™åˆ¶",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "predict_linear(etcd_mvcc_db_total_size_in_bytes[4h], 4*60*60) > etcd_server_quota_backend_bytes",
          "severity": 3,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd æœåŠ¡å¼‚å¸¸è¯·æ±‚ç‡è¿‡é«˜",
    "note": "etcd èŠ‚ç‚¹ gRPC å¼‚å¸¸è¯·æ±‚æ¯”ä¾‹è¿‡é«˜\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ å¼‚å¸¸è¯·æ±‚å æ¯”ï¼š{{ printf \"%.2f\" $value }}%  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šå¼‚å¸¸ gRPC è¯·æ±‚å æ¯”è¶…è¿‡ 1%\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ gRPC å¼‚å¸¸è¯·æ±‚å¢å¤šå¯èƒ½å¯¼è‡´ etcd æœåŠ¡å“åº”å¼‚å¸¸  \nâœ“ å¯èƒ½å¼•å‘é›†ç¾¤æ€§èƒ½ä¸‹é™æˆ–æ•°æ®åŒæ­¥å¤±è´¥  \nâœ“ å¯èƒ½ç”±ç½‘ç»œé—®é¢˜ã€èµ„æºè€—å°½ã€é…ç½®é”™è¯¯æˆ–èŠ‚ç‚¹å¼‚å¸¸å¼•èµ·  \n\nè¯·æ£€æŸ¥ etcd æœåŠ¡æ—¥å¿—ã€èŠ‚ç‚¹è´Ÿè½½åŠç½‘ç»œçŠ¶å†µï¼ŒåŠæ—¶æ’æŸ¥å¹¶å¤„ç†å¼‚å¸¸è¯·æ±‚",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "100 * sum(rate(grpc_server_handled_total{job=~\".*etcd.*\", grpc_code=~\"Unknown|FailedPrecondition|ResourceExhausted|Internal|Unavailable|DataLoss|DeadlineExceeded\"}[5m])) without (grpc_type, grpc_code)\n  /\nsum(rate(grpc_server_handled_total{job=~\".*etcd.*\"}[5m])) without (grpc_type, grpc_code)\n  > 1",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd èŠ‚ç‚¹å­˜æ´»çŠ¶æ€å¼‚å¸¸",
    "note": "etcd é›†ç¾¤æ£€æµ‹åˆ°èŠ‚ç‚¹å¼‚å¸¸æˆ–é€šä¿¡å¤±è´¥\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ è§¦å‘æ¡ä»¶ï¼š  \nâ€ƒ- å­˜åœ¨ etcd å®ä¾‹å®•æœºï¼ˆup = 0ï¼‰  \nâ€ƒ- æˆ– etcd èŠ‚ç‚¹é—´é€šä¿¡å­˜åœ¨å¤±è´¥ï¼ˆpeer_sent_failures > 0.01ï¼‰  \nâ–¸ å½“å‰å¼‚å¸¸å€¼ï¼š`{{ printf \"%.0f\" $value }}`\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ etcd æ˜¯é›†ç¾¤æœåŠ¡å‘ç°ä¸é…ç½®ä¸­å¿ƒï¼Œä»»ä¸€èŠ‚ç‚¹å¼‚å¸¸å¯èƒ½å½±å“ä¸»ä»é€‰ä¸¾  \nâœ“ ç½‘ç»œé€šä¿¡å¤±è´¥å¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€é€‰ä¸»é‡è¯•ã€å†™å…¥å¤±è´¥ç­‰é—®é¢˜  \nâœ“ å¤šä¸ªèŠ‚ç‚¹å¼‚å¸¸å°†ä¸¥é‡å½±å“ Kubernetesã€Prometheus ç­‰ä¾èµ–æœåŠ¡çš„å¯ç”¨æ€§  \n\nå»ºè®®ç«‹å³æ£€æŸ¥ etcd èŠ‚ç‚¹è¿è¡ŒçŠ¶æ€ã€ç½‘ç»œè¿é€šæ€§ã€ç£ç›˜å’Œ CPU ä½¿ç”¨æƒ…å†µï¼Œç¡®ä¿é›†ç¾¤é«˜å¯ç”¨",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "max without (endpoint) (\n  sum without (instance) (up{job=~\".*etcd.*\"} == bool 0)\nor\n  count without (To) (\n    sum without (instance) (rate(etcd_network_peer_sent_failures_total{job=~\".*etcd.*\"}[120s])) > 0.01\n  )\n)\n> 0",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd èŠ‚ç‚¹æ•°é‡ä¸è¶³å‘Šè­¦",
    "note": "etcd é›†ç¾¤å¤šæ•°èŠ‚ç‚¹å¤±è”ï¼Œé›†ç¾¤å¯èƒ½ä¸å¯ç”¨\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ å½“å‰å­˜æ´»èŠ‚ç‚¹æ•°ï¼š{{ printf \"%.0f\" $value }}  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šå­˜æ´»èŠ‚ç‚¹æ•°å°‘äº etcd é›†ç¾¤åŠæ•°èŠ‚ç‚¹æ•°\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ etcd é›†ç¾¤å¤±å»å¤šæ•°èŠ‚ç‚¹ï¼Œæ— æ³•å®Œæˆé€‰ä¸»ï¼Œé›†ç¾¤æœåŠ¡ä¸å¯ç”¨  \nâœ“ ä¾èµ– etcd çš„ä¸Šå±‚ç»„ä»¶ï¼ˆå¦‚ Kubernetesï¼‰å¯èƒ½å‡ºç°æœåŠ¡å¼‚å¸¸  \nâœ“ éœ€å°½å¿«æ’æŸ¥èŠ‚ç‚¹çŠ¶æ€å’Œç½‘ç»œé—®é¢˜ï¼Œæ¢å¤é›†ç¾¤å¤šæ•°èŠ‚ç‚¹  \n\nè¯·å°½å¿«æ£€æŸ¥ etcd èŠ‚ç‚¹çŠ¶æ€å’Œç½‘ç»œè¿é€šæ€§ï¼Œä¿éšœé›†ç¾¤é«˜å¯ç”¨",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "sum(up{job=~\".*etcd.*\"} == bool 1) without (instance) < ((count(up{job=~\".*etcd.*\"}) without (instance) + 1) / 2)",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Etcd èŠ‚ç‚¹é—´ç½‘ç»œå»¶è¿Ÿè¿‡é«˜å‘Šè­¦",
    "note": "etcd èŠ‚ç‚¹é—´ç½‘ç»œå»¶è¿Ÿå¼‚å¸¸å‡é«˜ï¼ˆ99 åˆ†ä½ï¼‰\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ å½“å‰ 99 åˆ†ä½ç½‘ç»œå»¶è¿Ÿï¼š{{ printf \"%.3f\" $value }} ç§’  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šetcd ç½‘ç»œå¾€è¿”å»¶è¿Ÿï¼ˆRTTï¼‰è¶…è¿‡ 0.15 ç§’\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ ç½‘ç»œå»¶è¿Ÿå‡é«˜ä¼šå½±å“ etcd èŠ‚ç‚¹é—´åŒæ­¥  \nâœ“ å¯èƒ½å¯¼è‡´ leader é€‰ä¸¾é¢‘ç¹ã€å†™å…¥å˜æ…¢  \nâœ“ å¯ç”±ç½‘ç»œæŠ–åŠ¨ã€å¸¦å®½å ç”¨ã€ç‰©ç†é“¾è·¯é—®é¢˜å¼•èµ·\n\nè¯·æ’æŸ¥èŠ‚ç‚¹é—´ç½‘ç»œè´¨é‡ï¼ˆå»¶è¿Ÿã€ä¸¢åŒ…ã€å¸¦å®½ï¼‰ï¼Œå¹¶æ£€æŸ¥ etcd æ—¥å¿—æ˜¯å¦å­˜åœ¨ leader å˜æ›´ç­‰å¼‚å¸¸",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "histogram_quantile(0.99, rate(etcd_network_peer_round_trip_time_seconds_bucket{job=~\".*etcd.*\"}[5m])) > 0.15",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Etcd"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  }
]