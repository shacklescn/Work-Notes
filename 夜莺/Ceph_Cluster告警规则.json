[
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Ceph Manager æœåŠ¡ä¸å¯ç”¨",
    "note": "\\n\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ é›†ç¾¤ï¼š`{{$labels.cluster}}`  \nâ–¸ å½“å‰ MGR çŠ¶æ€ï¼šæ— æ´»è·ƒï¼ˆceph_mgrs_active=0ï¼‰  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šCeph MGR æ•°é‡ä¸º 0\n\n**ğŸ“ é—®é¢˜åˆ†æ**  \nâœ“ Ceph Manager æ˜¯é›†ç¾¤ç›‘æ§ä¸ç®¡ç†çš„æ ¸å¿ƒç»„ä»¶  \nâœ“ æ— æ´»è·ƒ MGR èŠ‚ç‚¹å¯èƒ½å½±å“ Dashboardã€æ¨¡å—æ‰©å±•ã€ç›‘æ§æŒ‡æ ‡ä¸ŠæŠ¥ç­‰åŠŸèƒ½  \nâœ“ å¦‚é•¿æœŸæœªæ¢å¤ï¼Œéœ€æ£€æŸ¥ MGR å®¹å™¨ã€å®ˆæŠ¤è¿›ç¨‹æ˜¯å¦æ­£å¸¸è¿è¡Œ\n\n**ğŸ›  å¤„ç†å»ºè®®**  \n- ç™»å½•é›†ç¾¤èŠ‚ç‚¹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ MGR çŠ¶æ€ï¼š\n  ceph -s\n  ceph mgr dump",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "ceph_mgrs_active == 0",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Ceph"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Ceph MON èŠ‚ç‚¹ä¹‹é—´æ—¶é’Ÿåå·®è¶…é™å‘Šè­¦",
    "note": "{{$labels.instance}} Ceph Monitor èŠ‚ç‚¹æ—¶é’Ÿæ¼‚ç§»å¼‚å¸¸\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**\nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ å½“å‰æ—¶é’Ÿåå·®ï¼š{{ printf \"%.3f\" $value }} ç§’  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šCeph MON æ—¶é’Ÿåå·®è¶…è¿‡ 0.2 ç§’\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ å¤šä¸ª MON èŠ‚ç‚¹æ—¶é—´ä¸ä¸€è‡´ï¼Œå¯èƒ½å½±å“é€‰ä¸»ä¸é›†ç¾¤ä¸€è‡´æ€§  \nâœ“ æ—¶é—´æ¼‚ç§»å¯èƒ½å¯¼è‡´ PG çŠ¶æ€ã€å¿ƒè·³ç›‘æ§ç­‰å‡ºç°å¼‚å¸¸  \nâœ“ é›†ç¾¤å¯èƒ½é¢‘ç¹å‘Šè­¦æˆ–è¡Œä¸ºå¼‚å¸¸ï¼ˆä¾‹å¦‚å¥åº·æ£€æŸ¥è¯¯æŠ¥ï¼‰  \n\nè¯·æ£€æŸ¥è¯¥èŠ‚ç‚¹çš„ NTP æœåŠ¡æ˜¯å¦æ­£å¸¸ï¼Œç¡®ä¿æ‰€æœ‰ MON èŠ‚ç‚¹æ—¶é—´åŒæ­¥",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "abs(ceph_monitor_clock_skew_seconds) > 0.2",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Ceph"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Ceph OSD å†™å…¥å»¶è¿Ÿè¿‡é«˜å‘Šè­¦",
    "note": "{{$labels.instance}} ä¸Šçš„ OSD å†™å…¥å»¶è¿Ÿè¿‡é«˜\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**\nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ OSD åç§°ï¼š`{{$labels.osd}}`  \nâ–¸ å½“å‰å†™å…¥åº”ç”¨å»¶è¿Ÿï¼š{{ printf \"%.2f\" $value }} ç§’  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šceph_osd_perf_apply_latency_seconds > 5\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ OSD å†™å…¥å»¶è¿Ÿé«˜å¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯ I/O æ€§èƒ½ä¸‹é™  \nâœ“ å¯èƒ½ç”±äºç£ç›˜æ€§èƒ½ä¸‹é™ã€I/O æ‹¥å¡æˆ– OSD å®•æœºæ¢å¤å¼•èµ·  \nâœ“ å»¶è¿Ÿè¿‡é«˜å¯èƒ½å¯¼è‡´æ•´ä½“é›†ç¾¤è¯»å†™å¡é¡¿ç”šè‡³æŒ‚èµ·  \n\nè¯·æ£€æŸ¥å¯¹åº” OSD æ‰€åœ¨ç£ç›˜å’ŒèŠ‚ç‚¹è´Ÿè½½ï¼ŒåŠæ—¶ä¼˜åŒ–æˆ–è¿ç§»æ•°æ®ï¼Œç¡®ä¿é›†ç¾¤æ€§èƒ½",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "ceph_osd_perf_apply_latency_seconds > 5",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Ceph"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Ceph OSD ç£ç›˜ä½¿ç”¨ç‡å‘Šè­¦",
    "note": "{{$labels.instance}} ä¸Šçš„ OSD ä½¿ç”¨ç‡è¶…è¿‡ 90%\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**\nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ OSD åç§°ï¼š`{{$labels.osd}}`  \nâ–¸ å½“å‰ OSD åˆ©ç”¨ç‡ï¼š{{ printf \"%.1f\" $value }}%  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šceph_osd_utilization > 90%\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ å•ä¸ª OSD ä½¿ç”¨ç‡è¿‡é«˜ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®å†™å…¥å¤±è´¥  \nâœ“ Ceph åˆ†å¸ƒç­–ç•¥å¯èƒ½å¯¼è‡´è´Ÿè½½ä¸å‡  \nâœ“ å¦‚æœæŒç»­æ¶åŒ–ï¼Œå¯èƒ½å½±å“æ•´ä¸ªé›†ç¾¤çš„è¯»å†™æ€§èƒ½å’Œæ•°æ®å¯é æ€§  \n\nè¯·å°½å¿«æ£€æŸ¥ OSD å­˜å‚¨ä½¿ç”¨æƒ…å†µï¼Œè€ƒè™‘å‡è¡¡æ•°æ®ã€å‰¯æœ¬é‡å¹³è¡¡æˆ–æ‰©å®¹é›†ç¾¤",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 1,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "ceph_osd_utilization > 90",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Ceph"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 15s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Ceph PG çŠ¶æ€å¼‚å¸¸å‘Šè­¦",
    "note": "Ceph é›†ç¾¤å­˜åœ¨é active çŠ¶æ€çš„ PG\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**\nâ–¸ å¼‚å¸¸ PG æ•°é‡ï¼š{{ printf \"%.0f\" $value }} ä¸ª  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šå­˜åœ¨é active çŠ¶æ€çš„ PGï¼ˆceph_total_pgs - ceph_active_pgs > 0ï¼‰\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ é active çŠ¶æ€çš„ PG è¡¨æ˜é›†ç¾¤å­˜åœ¨å‰¯æœ¬æœªåŒæ­¥æˆ–æ•…éšœæ¢å¤ä¸­  \nâœ“ å¯èƒ½å½±å“æ•°æ®è®¿é—®çš„å¯ç”¨æ€§å’Œä¸€è‡´æ€§  \nâœ“ æŒç»­å¼‚å¸¸å¯èƒ½å¯¼è‡´ I/O æ€§èƒ½ä¸‹é™æˆ–è¯»å†™é˜»å¡  \n\nè¯·ç«‹å³æ£€æŸ¥ Ceph é›†ç¾¤çŠ¶æ€ï¼Œç¡®è®¤ PG çŠ¶æ€ï¼ˆå¦‚ degradedã€remappedã€backfilling ç­‰ï¼‰ï¼Œå¹¶æ ¹æ®å®é™…æƒ…å†µé‡‡å–ä¿®å¤æªæ–½",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 120,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "ceph_total_pgs - ceph_active_pgs > 0",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Ceph"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 120s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Ceph å­˜å‚¨èŠ‚ç‚¹ OSD å¼‚å¸¸",
    "note": "{{$labels.instance}} ä¸Šçš„ OSD å·²ä¸‹çº¿\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.host}}`  \nâ–¸ OSD ç¼–å·ï¼š`{{$labels.osd}}`  \nâ–¸ å½“å‰çŠ¶æ€ï¼šå·²ä¸‹çº¿ï¼ˆceph_osd_up = 0ï¼‰  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šOSD çŠ¶æ€ä¸º down\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ Ceph é›†ç¾¤å‰¯æœ¬å®Œæ•´æ€§å¯èƒ½å—å½±å“  \nâœ“ å¯èƒ½å¯¼è‡´éƒ¨åˆ† PG çŠ¶æ€å¼‚å¸¸ï¼ˆå¦‚ degradedã€inactiveï¼‰  \nâœ“ è‹¥æŒç»­ç¦»çº¿ï¼Œå¯èƒ½è§¦å‘æ•°æ®è¿ç§»ã€æ€§èƒ½ä¸‹é™æˆ– IO é”™è¯¯  \n\nè¯·å°½å¿«æ£€æŸ¥ OSD å®¿ä¸»æœºçŠ¶æ€ã€ç½‘ç»œè¿æ¥ã€ç£ç›˜å¥åº·ç­‰ï¼ŒåŠæ—¶ä¿®å¤æˆ–æ›¿æ¢",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "ceph_osd_up == 0",
          "severity": 1,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Ceph"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Ceph é›†ç¾¤å¥åº·çŠ¶æ€å¼‚å¸¸",
    "note": "Ceph é›†ç¾¤å¥åº·çŠ¶æ€å¼‚å¸¸\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**\nâ–¸ èŠ‚ç‚¹å®ä¾‹ï¼š`{{$labels.instance}}`  \nâ–¸ å½“å‰å¥åº·çŠ¶æ€ä»£ç ï¼š`{{ $value }}`  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šceph_health_status != 0ï¼ˆé HEALTH_OKï¼‰\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ Ceph é›†ç¾¤å¯èƒ½å­˜åœ¨ç£ç›˜æ•…éšœã€PG å¼‚å¸¸ã€OSD æ‰çº¿ã€ç½‘ç»œåˆ†åŒºç­‰é—®é¢˜  \nâœ“ HEALTH_WARN è¯´æ˜å­˜åœ¨å¯å®¹å¿çš„å¼‚å¸¸ï¼Œéœ€å°½å¿«å¤„ç†  \nâœ“ HEALTH_ERR è¡¨ç¤ºå­˜åœ¨ä¸¥é‡é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®ä¸å¯ç”¨æˆ–ä¸¢å¤±  \n\nè¯·ç™»å½• Ceph ç®¡ç†èŠ‚ç‚¹æ‰§è¡Œ `ceph health detail`ï¼ŒæŸ¥çœ‹å…·ä½“å¼‚å¸¸é¡¹å¹¶åŠæ—¶ä¿®å¤",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "ceph_health_status != 0",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Ceph"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  },
  {
    "cate": "prometheus",
    "datasource_queries": [
      {
        "match_type": 0,
        "op": "in",
        "values": [
          1
        ]
      }
    ],
    "name": "Ceph é›†ç¾¤å‰©ä½™å®¹é‡ä¸è¶³",
    "note": "\\n\n**ğŸ“Œ æ£€æµ‹æŒ‡æ ‡ä¿¡æ¯**  \nâ–¸ å®ä¾‹èŠ‚ç‚¹ï¼š`{{$labels.instance}}`  \nâ–¸ å½“å‰å‰©ä½™å®¹é‡æ¯”ä¾‹ï¼š`{{ printf \"%.2f\" $value }}%`  \nâ–¸ è§¦å‘æ¡ä»¶ï¼šå‰©ä½™å®¹é‡ä½äº 15%\n\n**ğŸ“ å½±å“åˆ†æ**  \nâœ“ å¯ç”¨ç©ºé—´ä¸è¶³ï¼Œå¯èƒ½å¯¼è‡´å†™å…¥å¤±è´¥æˆ–é›†ç¾¤å˜ä¸ºåªè¯»  \nâœ“ æŒç»­å†™å…¥å¯èƒ½é€ æˆ PG åˆ†å¸ƒå¼‚å¸¸ï¼Œå½±å“æ•°æ®å‡è¡¡å’Œæ€§èƒ½  \nâœ“ å­˜å‚¨å‹åŠ›å¢å¤§ä¼šå½±å“æ•´ä½“é›†ç¾¤ç¨³å®šæ€§å’Œæ‰©å±•æ€§\n\n**ğŸ›  å¤„ç†å»ºè®®**  \n- ä½¿ç”¨ `ceph df` å‘½ä»¤æŸ¥çœ‹å½“å‰å­˜å‚¨å ç”¨  \n- æ’æŸ¥æ˜¯å¦æœ‰æ— æ•ˆæ•°æ®æˆ–å¤§æ•°æ®å¯¼å…¥ä»»åŠ¡  \n- åŠæ—¶æ¸…ç†æ— æ•ˆå¿«ç…§ã€å¯¹è±¡ã€æ—¥å¿—ç­‰  \n- è€ƒè™‘æ·»åŠ æ–°çš„ OSD æˆ–èŠ‚ç‚¹æ‰©å®¹\n\nè¯·å°½å¿«å¤„ç†ï¼Œé¿å… Ceph é›†ç¾¤è¿›å…¥åªè¯»æˆ–ä¸å¯ç”¨çŠ¶æ€ã€‚",
    "prod": "metric",
    "delay": 0,
    "prom_for_duration": 60,
    "rule_config": {
      "queries": [
        {
          "prom_ql": "ceph_osd_total_avail_bytes{} / (ceph_osd_total_used_bytes{} + ceph_osd_total_avail_bytes{}) * 100 < 15",
          "severity": 2,
          "unit": "none"
        }
      ]
    },
    "event_relabel_config": null,
    "prom_eval_interval": 15,
    "enable_in_bg": 0,
    "notify_recovered": 1,
    "notify_repeat_step": 60,
    "notify_max_number": 0,
    "recover_duration": 0,
    "callbacks": [],
    "append_tags": [
      "App=Ceph"
    ],
    "annotations": {},
    "uuid": 0,
    "cur_event_count": 0,
    "update_by_nickname": "è¶…ç®¡",
    "cron_pattern": "@every 60s",
    "notify_rule_ids": [
      1
    ],
    "notify_version": 1
  }
]